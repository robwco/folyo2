<% content_for :title, "Recent Leads" %>
<style>
a.favorite {float: right; border: 1px solid #222; padding: 0 .35em; border-radius: 4px; text-decoration: none;}
a.favorite:hover { background-color: #222; color: white;}
input.search-bar { width: 175px !important; height: 30px; margin: 0 !important;margin-right: .25em;}
input.search-button {height: 30px; padding: 0; font-size: 14px !important;}
}
</style>

<div class="wrapper" style="width: 35em; padding: 2em 0;">
	
<% if admin_signed_in? %>
	Admin Options:
	<%= link_to "New Lead", new_lead_path, :class => "button" %>
	<%= link_to "Upload RFP", new_rfp_path, :class => "button" %>
	<hr>
<% end %>


	<table style="margin: 0; width: 35em;">
		<thead style="font-weight: 300; text-align: left;">
			<tr>
				<th style="font-weight: 300;">
					<%= render "search" %>	
				</th>
			</tr>
		</thead>

	  <tbody>
	    <% @leads.most_recent.each do |lead| %>
	      <tr>
	        <td style="border-bottom: 1px solid #ccc; padding: 0 0 1em;">
						<p style="margin: 1em 0 0; font-size: 20px;"><strong><%= lead.title %></strong></p>
						<p style="color: #666; font-size: 14px; margin: .125em 0;white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 560px;"> Original Source: <a href="<%= lead.url %>" style="color: #666;"><%= lead.url %></a></p>
						<p style="margin: .5em 0 0;"><%= simple_format(lead.description) %></p>
						<% if lead.image.file? %>
						  <%= image_tag lead.image.url(:medium, timestamp: false), :style => "width: 50px; height: 50px; border-radius: 65px; margin: 1em 0 0;"  %>
						<% else %>
						<% end %>
						<p style="font-size: 16px; margin: .5em 0;">
							Name: <%= lead.name %></strong>
						<br>Email: <%= mail_to lead.email %>
						<br>
						</p>
						<p style=" margin: .5em 0;"><span style="color: #666; font-size: 14px;">Posted on <%= lead.created_at.strftime("%b. %d %Y") %> in <%= lead.category_name %></span> 
						
						
						
						
							<% if admin_signed_in? %>
							<span style="float: right; color: #666; font-size: 14px;">
								Admin Options: <%= link_to 'Edit', edit_lead_path(lead) %>, <%= link_to 'Delete', lead_path(lead), method: :delete, data: { confirm: 'Are you sure?' } %>
							</span>
							<% else %>
								<% unless current_user.favorites.include?(lead) %>
									<%= link_to "Favorite", favorite_lead_path(lead, type: "favorite"), method: :patch, :class => "favorite" %>
								<% else %><span style="float: right; color: #666; font-size: 14px;">Favorited</span>
								<% end %>
							<% end %>
								

						
							
							
						 </p>
					</td>
	      </tr>
	    <% end %>
	  </tbody>
	</table>

	<%= will_paginate @leads unless params[:advanced].blank? %>

	<div style="width: 100%;text-align:center; font-size: 23px; line-height: 5em;">
	<a href="/favorites">Your Favorites</a>
	</div>
	<hr>
	<div style="width: 100%;text-align:center; font-size: 23px; line-height: 3em;">
	<a href="/users/edit">Edit Your Subscription</a>
	</div>
	
</div>
